<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>מערכת תזכורות תשלום - התראות</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <h1>התראות תשלום להיום: <span id="currentDate"></span></h1>
        
        <div id="alertsContainer">
            </div>

        <a href="index.html">חזרה להזנת לקוחות</a>
        <button onclick="checkAlerts()">רענן בדיקת התראות</button>
    </div>

    <script>
        function checkAlerts() {
            const today = new Date();
            // היום הנוכחי בחודש (לדוגמה: 17)
            const todayDayOfMonth = today.getDate(); 
            const alertsContainer = document.getElementById('alertsContainer');
            alertsContainer.innerHTML = ''; 
            
            // הצגת התאריך הנוכחי
            const dateOptions = { year: 'numeric', month: 'long', day: 'numeric' };
            document.getElementById('currentDate').textContent = today.toLocaleDateString('he-IL', dateOptions);

            // שליפת הנתונים השמורים
            const clientsJson = localStorage.getItem('monthlyClients');
            const clients = clientsJson ? JSON.parse(clientsJson) : [];
            let alertsFound = false;

            clients.forEach(client => {
                // הבדיקה המרכזית: האם יום התשלום השמור זהה ליום הנוכחי בחודש
                if (client.day === todayDayOfMonth) {
                    alertsFound = true;
                    const alertDiv = document.createElement('div');
                    alertDiv.className = 'alert-item';
                    alertDiv.innerHTML = `
                        <div class="alert-details">
                            <strong>תזכורת דחופה!</strong> יש ליצור קשר עם הלקוח: 
                            <span style="font-weight:bold; font-size:1.2em;">${client.name}</span>
                        </div>
                        <div class="alert-time">
                            יום תשלום חודשי: ${client.day} | שעה מומלצת: ${client.time}
                            ${client.startDate ? '<br><span>תאריך התחלה: ' + client.startDate + '</span>' : ''}
                        </div>
                    `;
                    alertsContainer.appendChild(alertDiv);
                }
            });

            if (!alertsFound) {
                alertsContainer.innerHTML = '<div class="no-alerts">🎉 אין תזכורות תשלום להיום. כל הכבוד! 🎉</div>';
            }
        }

        // הפעלת הבדיקה מיד לאחר טעינת הדף
        checkAlerts();
    </script>
</body>
</html>
